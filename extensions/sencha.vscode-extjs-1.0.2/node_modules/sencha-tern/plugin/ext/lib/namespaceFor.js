var appFor = require('./appFor'),
    path = require('path'),
    _ = require('lodash'),
    util = require('./util');

/**
 * Returns the class namespace corresponding to a given directory based on it's location within an app or package
 * @param {String} dir A full path or path relative to the project root
 * @returns {string}
 */
module.exports = function namespaceFor(dir) {
    dir = path.resolve(dir);
    var app = appFor(dir);

    if (app) {
        var appRoot = path.resolve(app.path);
        return util.replaceAll(dir.substring(appRoot.length), path.sep, '.').replace(/^\.?(app|classic(\.src)?|modern(\.src)?|src)/, app.name);
    }
};

