"use strict";

var should = require('./../lib/chai_setup'),
    namespaceFor = require('../../../ext/lib/namespaceFor'),
    path = require('path'),
    TestUtil = require('../lib/test_util');

describe('namespaceFor', function() {
    beforeEach(function() {
        global.tern.apps = [{
            path: path.resolve('/home'),
            name: 'Test'
        }];
    });

    afterEach(TestUtil.cleanup); // rebuild the server before each test so that test classes don't bleed over between tests

    it('should handle app paths', function() {
        namespaceFor(path.resolve('/home/app')).should.eq('Test');
        namespaceFor(path.resolve('/home/app/')).should.eq('Test');
        namespaceFor(path.resolve('/home/app/view')).should.eq('Test.view');
        namespaceFor(path.resolve('/home/classic/src/view/user')).should.eq('Test.view.user');
        namespaceFor(path.resolve('/home/modern/src/view')).should.eq('Test.view');
    });

    it('should handle package paths', function() {
        namespaceFor(path.resolve('/home/src')).should.eq('Test');
        namespaceFor(path.resolve('/home/src/view')).should.eq('Test.view');
        namespaceFor(path.resolve('/home/classic/view')).should.eq('Test.view');
        namespaceFor(path.resolve('/home/modern/view')).should.eq('Test.view');
    });
});