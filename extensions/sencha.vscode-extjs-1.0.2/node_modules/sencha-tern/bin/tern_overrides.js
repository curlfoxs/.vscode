/*
Added by MB 9/2015.  This file adds new functionality to the tern command line process
 */

var os = require('../lib/os'),
    net = require('net'),
    moment = require('moment'),
    _ = require('lodash'),
    FileUtil = require('../plugin/ext/lib/FileUtil');

// use --dir argument as working directory if present
var dirArg = process.argv.indexOf("--dir");
if (dirArg > -1) {
    process.chdir(process.argv[dirArg + 1])
}

// create .sencha/temp/.ide dir and ignore it
FileUtil.ensureSenchaDirs(process.cwd());

// normalize process.cwd() on windows, which returns the volume letter as lower case but everything else seems to
// return it as upper case
if (os.isWindows) {
    var _cwd = process.cwd;
    process.cwd = function() {
        return _cwd().replace( /^([a-z]):/, function(v) { return v.toUpperCase() });
    };
}

// if --version is present display the tern and tern-ext versions in json and exit
if (process.argv.indexOf('--version') !== -1) {
    console.log(require('../plugin/ext/lib/version'));
    process.exit();
}
