{
    "Snippet: PageWizard": {
        "description": "Snippet (CRS): Wizard Page (3 steps)",
        "prefix": "tpagewizard (CRS: 3 steps)",
        "body": [
            "page ${1:Id} \"${2:PageName} Wizard\"",
            "{",
            "\tCaption='${2:PageName}';",
            "\tPageType = NavigatePage;",
            "\tSourceTable = ${3:\"TableName\"};",
            "\tSourceTableTemporary=true;",
            "",
            "\tlayout",
            "\t{",
            "\t\tarea(content)",
            "\t\t{",
            "\t\t\tgroup(StandardBanner)",
            "\t\t\t{",
            "\t\t\t\tCaption='';",
            "\t\t\t\tEditable=false;",
            "\t\t\t\tVisible=TopBannerVisible and not FinishActionEnabled;",
            "\t\t\t\tfield(MediaResourcesStandard;MediaResourcesStandard.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t  ApplicationArea = All;",
            "\t\t\t\t  Editable=false;",
            "\t\t\t\t  ShowCaption=false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\tgroup(FinishedBanner)",
            "\t\t\t{",
            "\t\t\t\tCaption='';",
            "\t\t\t\tEditable=false;",
            "\t\t\t\tVisible=TopBannerVisible and FinishActionEnabled;",
            "\t\t\t\tfield(MediaResourcesDone;MediaResourcesDone.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t  ApplicationArea = All;",
            "\t\t\t\t  Editable=false;",
            "\t\t\t\t  ShowCaption=false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "",
            "\t\t\tgroup(Step1)",
            "\t\t\t{",
            "\t\t\t\tVisible=Step1Visible;",
            "\t\t\t\tgroup(\"Welcome to ${2:PageName}\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='Welcome to ${2:PageName} Setup';",
            "\t\t\t\t\tVisible=Step1Visible;",
            "\t\t\t\t\tgroup(Group18)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tCaption='';",
            "\t\t\t\t\t\tInstructionalText='Step1 - Replace this text with some instructions.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t\tgroup(\"Let's go!\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='Let''s go!';",
            "\t\t\t\t\tgroup(Group22)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tCaption='';",
            "\t\t\t\t\t\tInstructionalText='Step1 - Replace this text with some more instructions.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t}",
            "",
            "\t\t\tgroup(Step2)",
            "\t\t\t{",
            "\t\t\t\tCaption='';",
            "\t\t\t\tInstructionalText='Step2 - Replace this text with some instructions.';",
            "\t\t\t\tVisible=Step2Visible;",
            "\t\t\t\t//You might want to add fields here",
            "\t\t\t}",
            "\t\t\t",
            "",
            "\t\t\tgroup(Step3)",
            "\t\t\t{",
            "\t\t\t\tVisible=Step3Visible;",
            "\t\t\t\tgroup(Group23)",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='';",
            "\t\t\t\t\tInstructionalText='Step3 - Replace this text with some instructions.';",
            "\t\t\t\t}",
            "\t\t\t\tgroup(\"That's it!\")",
            "\t\t\t\t{",
            "\t\t\t\t\tCaption='That''s it!';",
            "\t\t\t\t\tgroup(Group25)",
            "\t\t\t\t\t{",
            "\t\t\t\t\t\tCaption='';",
            "\t\t\t\t\t\tInstructionalText='To save this setup, choose Finish.';",
            "\t\t\t\t\t}",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t}",
            "\t}",
            "actions",
            "{",
            "\tarea(processing)",
            "\t{",
            "\t\taction(ActionBack)",
            "\t\t{",
            "\t\t\tApplicationArea = All;",
            "\t\t\tCaption='Back';",
            "\t\t\tEnabled=BackActionEnabled;",
            "\t\t\tImage=PreviousRecord;",
            "\t\t\tInFooterBar=true;",
            "\t\t\ttrigger OnAction();",
            "\t\t\tbegin",
            "\t\t\t\tNextStep(true);",
            "\t\t\tend;",
            "\t\t}",
            "\t\taction(ActionNext)",
            "\t\t{",
            "\t\t\tApplicationArea = All;",
            "\t\t\tCaption='Next';",
            "\t\t\tEnabled=NextActionEnabled;",
            "\t\t\tImage=NextRecord;",
            "\t\t\tInFooterBar=true;",
            "\t\t\ttrigger OnAction();",
            "\t\t\tbegin",
            "\t\t\t\tNextStep(false);",
            "\t\t\tend;",
            "\t\t}      ",
            "\t\taction(ActionFinish)",
            "\t\t{",
            "\t\t\tApplicationArea = All;",
            "\t\t\tCaption='Finish';",
            "\t\t\tEnabled=FinishActionEnabled;",
            "\t\t\tImage=Approve;",
            "\t\t\tInFooterBar=true;",
            "\t\t\ttrigger OnAction();",
            "\t\t\tbegin",
            "\t\t\t\tFinishAction();",
            "\t\t\tend;",
            "\t\t}",
            "\t}",
            "}",
            "trigger OnInit();",
            "begin",
            "  LoadTopBanners();",
            "end;",
            "trigger OnOpenPage();",
            "var",
            "\t${4:RecordVar} : Record ${3:TableName};",
            "begin",
            "\tInit();",
            "\tif ${4:RecordVar}.Get() then",
            "\t  TransferFields(${4:RecordVar});",
            "\t",
            "\tInsert();",
            "",
            "\tStep := Step::Start;",
            "\tEnableControls();",
            "end;",
            "var",
            "\tMediaRepositoryDone : Record \"Media Repository\";",
            "\tMediaRepositoryStandard : Record \"Media Repository\";",
            "\tMediaResourcesDone : Record \"Media Resources\";",
            "\tMediaResourcesStandard : Record \"Media Resources\";",
            "\tStep : Option Start,Step2,Finish;",
            "\tBackActionEnabled : Boolean;",
            "\tFinishActionEnabled : Boolean;",
            "\tNextActionEnabled : Boolean;",
            "\tStep1Visible : Boolean;",
            "\tStep2Visible : Boolean;",
            "\tStep3Visible : Boolean;",
            "\tTopBannerVisible : Boolean;",
            "local procedure EnableControls();",
            "begin",
            "  ResetControls();",
            "",
            "  case Step of",
            "    Step::Start:",
            "      ShowStep1();",
            "    Step::Step2:",
            "      ShowStep2();",
            "    Step::Finish:",
            "      ShowStep3();",
            "  end;",
            "end;",
            "",
            "local procedure Store${4:RecordVar}();",
            "var",
            "\t${4:RecordVar} : Record ${3:TableName};",
            "begin",
            "\tif not ${4:RecordVar}.Get() then begin",
            "\t\t${4:RecordVar}.Init();",
            "\t\t${4:RecordVar}.Insert();",
            "\tend;",
            "",
            "\t${4:RecordVar}.TransferFields(Rec,false);",
            "\t${4:RecordVar}.Modify(true);",
            "end;",
            "",
            "",
            "local procedure FinishAction();",
            "begin",
            "  Store${4:RecordVar}();",
            "  CurrPage.Close();",
            "end;",
            "",
            "local procedure NextStep(Backwards : Boolean);",
            "begin",
            "  if Backwards then",
            "    Step := Step - 1",
            "  ELSE",
            "    Step := Step + 1;",
            "",
            "  EnableControls();",
            "end;",
            "",
            "local procedure ShowStep1();",
            "begin",
            "  Step1Visible := true;",
            "",
            "  FinishActionEnabled := false;",
            "  BackActionEnabled := false;",
            "end;",
            "",
            "local procedure ShowStep2();",
            "begin",
            "  Step2Visible := true;",
            "end;",
            "",
            "local procedure ShowStep3();",
            "begin",
            "  Step3Visible := true;",
            "",
            "  NextActionEnabled := false;",
            "  FinishActionEnabled := true;",
            "end;",
            "",
            "local procedure ResetControls();",
            "begin",
            "  FinishActionEnabled := false;",
            "  BackActionEnabled := true;",
            "  NextActionEnabled := true;",
            "",
            "  Step1Visible := false;",
            "  Step2Visible := false;",
            "  Step3Visible := false;",
            "end;",
            "",
            "local procedure LoadTopBanners();",
            "begin",
            "  if MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CurrentClientType())) AND",
            "     MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CurrentClientType()))",
            "  then",
            "    if MediaResourcesStandard.GET(MediaRepositoryStandard.\"Media Resources Ref\") AND",
            "       MediaResourcesDone.GET(MediaRepositoryDone.\"Media Resources Ref\")",
            "    then",
            "      TopBannerVisible := MediaResourcesDone.\"Media Reference\".HasValue();",
            "end;",
            "}"
        ]
    }
}
